cat /etc/os_release             # Проверка версии системы

обновить Debian 9 10 11

1. Очистка системы
Первое правило безопасного обновления - чем меньше программного обеспечения 
установлено в вашей системе, тем выше шансы, что обновление пройдет без проблем. 
Сторонние пакеты, а тем более PPA и другие репозитории очень сильно уменьшают 
шансы того, что обновление пройдет без проблем. Поэтому перед обновлением лучше 
удалить все пакеты из системы.

Вы можете найти все сторонние пакеты с помощью утилиты aptitude:

sudo aptitude search '~i(!~ODebian)'

2. Обновление существующей системы
Второе правило для выполнения максимально безопасного обновления - ваша система 
должна быть обновлена до самой последней версии. Для этого выполните:

sudo apt update
sudo apt dist-upgrade

Если все прошло хорошо, выполните проверку целостности базы данных:

dpkg -C

Затем проверьте нет ли отложенных пакетов:

apt-mark showhold

Отложенные пакеты не могут быть обновлены, они могут стать проблемой при 
обновлении до Debian 10. Прежде чем пойти дальше исправьте все проблемы, эта 
команда может вам помочь:

dpkg --audit

3. Настройка репозиториев

Теперь наша система полностью обновлена и готова к переходу на новую версию и 
вот ответ на вопрос как обновить debian 9 до debian 10. Для этого нужно 
отредактировать файл /etc/apt/sources.list и заменить в нем все репозитории 
stretch на buster. Сначала создайте резервную копию существующего файла:

cp /etc/apt/sources.list /etc/apt/sources.list_backup

Затем откройте файл для редактирования, с помощью vim или apt edit sources и 
замените все вхождения слова stretch на buster:

vi /etc/apt/sources.list

#БЫЛО:
 deb http://httpredir.debian.org/debian stretch main
 deb http://httpredir.debian.org/debian stretch-updates main
 deb http://security.debian.org stretch/updates main
#СТАЛО:
 deb http://httpredir.debian.org/debian buster main
 deb http://httpredir.debian.org/debian buster-updates main
 deb http://security.debian.org buster/updates main

 Вместо ручного редактирования вы можете использовать команду sed, но лучше 
 сделать вручную:

sed -i 's/stretch/buster/g' /etc/apt/sources.list

Далее сохраните изменения если использовали редактор и обновите список 
репозиториев:

apt update

Следующей командой вы можете посмотреть список пакетов для обновления:

apt list --upgradable


4. Обновление до Debian 10

Все подготовительные шаги завершены и нам остался последний - 
обновить Debian 9 до 10. Для этого выполните команды:

apt-get upgrade

apt-get dist-upgrade

Во время обновления установщик может попросить разрешение на перезапуск 
нескольких системных служб. Это приостановит процесс установки и чтобы его 
продолжить вам придется согласится. Обновление займет некоторое время, в 
зависимости от скорости вашего интернета и производительности процессора. 
Теперь вы знаете как обновиться до Debian 10.


5. Проверка версии системы

После завершения обновления перезагрузите компьютер. Далее вы можете проверить 
насколько все успешно прошло с помощью команды:

cat /etc/os_release

Здесь вы должны увидеть, что у вас установлена десятая версия системы.

###############################################################################
########		Шаг 1. Обновление Debian 10 до актуальной версии
###############################################################################

Перед заменой репозиториев крайне желательно привести текущие пакеты до 
актуальной версии. Debian 10 за время существования успел получить несколько 
обновлений. Последняя версия получила номер 10.10, именно её и стоит обновлять 
до Debian 11.

Чтобы узнать текущую версию дистрибутива используйте команду:

cat /etc/debian_version

Чтобы обновить дистрибутив Debian, а заодно привести пакеты в порядок, 
выполните команды:

sudo apt update

sudo apt dist-upgrade

sudo apt --fix-broken install

sudo apt autoremove

После этого при проверке будет указана версия 10.10. Перед следующим шагом 
можете перезагрузить компьютер, чтобы убедиться в том, что обновлённая система 
успешно запускается.


Шаг 2. Замена репозиториев

Замена репозиториев – это основной этап обновления Debian 11. Именно эти 
файловые серверы содержат все пакеты дистрибутива. Список репозиториев хранится 
в файле /etc/apt/sources.list. Для доступа к нему воспользуемся редактором nano:

sudo nano /etc/apt/sources.list

В этом файле нам необходимо заменить buster на bullseye. Помимо этого, 
потребуется заменить /updates на -security, так как в Debian 11 изменили 
наименование для security группы репозиториев.

Не забудьте обновить список пакетов командой:

sudo apt update

Теперь ваш дистрибутив готов к обновлению.

Шаг 3. Минимальное обновление

Обновление рекомендуется проводить в два этапа. На первом этапе мы проведём 
минимальное обновление. Оно заменит только те пакеты, которые не потребуют 
установку или удаление других пакетов. Для этого используйте команду:

sudo apt upgrade --without-new-pkgs

В процессе обновления будут задавать вопросы, используйте Tab, чтобы 
переключаться между кнопками, и Пробел, чтобы выбирать нужный пункт.

Несмотря на то, что обновление называется минимальным, будет обновлена большая 
часть пакетов. После перезагрузки компьютера вас встретит практически готовый 
вариант Debian 11.

Шаг 4. Полное обновление

Если минимальное обновление прошло успешно, то пора приступать к полному 
обновлению системы командой:

sudo apt dist-upgrade

В процессе обновления будут установлены новые пакеты зависимостей, а часть 
старых, не привязанных ни к одной программе, останется в системе. Для удаления 
этих пакетов воспользуйтесь командой:

sudo apt autoremove


Шаг 5. Готово

Теперь можете ещё раз проверить установленную версию дистрибутива, ядра, 
оболочки и загрузчика:

cat /etc/debian_version

uname -r

gnome-shell --version

dpkg -l | grep grub